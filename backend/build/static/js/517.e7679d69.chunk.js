"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[517],{5564:function(e,t,a){a.d(t,{U2:function(){return l},v_:function(){return s}});var n=a(5861),r=a(7757),i=a.n(r),o=a(9158),l=function(e){var t=e.url,a=e.token,r=e.action;return(0,n.Z)(i().mark((function e(){var n,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.h.get({url:t,token:a,withCredentials:!1});case 3:return n=e.sent,e.abrupt("return",r({success:!0,data:n.data}));case 7:return e.prev=7,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",r({success:!1,message:null===e.t0||void 0===e.t0||null===(l=e.t0.response)||void 0===l?void 0:l.data}));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))},s=function(e){var t=e.url,a=e.token,r=e.action,l=e.data;return function(){var e=(0,n.Z)(i().mark((function e(n){var s,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.h.post({url:t,params:l,withCredentials:!1,token:a});case 3:return s=e.sent,e.abrupt("return",r({success:!0,data:s.data}));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",r({success:!1,message:null===e.t0||void 0===e.t0||null===(u=e.t0.response)||void 0===u?void 0:u.data,error:null===e.t0||void 0===e.t0?void 0:e.t0.response}));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}},2730:function(e,t,a){var n=a(9434),r=a(3504),i=a(6326),o=a(184);t.Z=function(){var e=(0,n.v9)((function(e){var t;return null===e||void 0===e||null===(t=e.auth)||void 0===t?void 0:t.token})),t=(0,n.I0)();return(0,o.jsxs)("div",{className:" flex bg-blue-400 h-16 px-12 justify-between items-center ",children:[(0,o.jsx)(r.rU,{to:"/",className:"hover:text-red-600",children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0441 \u043f\u043e\u0441\u0442\u0430\u043c\u0438"}),e?(0,o.jsx)("p",{onClick:function(){return t((0,i.R)())},className:"cursor-pointer hover:text-red-600 ",children:"Wyhod"}):(0,o.jsx)(r.rU,{to:"/login",className:"hover:text-red-600",children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"})]})}},9517:function(e,t,a){a.r(t),a.d(t,{default:function(){return O}});var n=a(885),r=a(2982),i=a(1413),o=a(2791),l=a(2730),s=a(639),u=a(392),c=a(3113),d=a(127),m=a(1401),v=a(184);var p=function(e){var t=e.openModal,a=e.handleSearch,n=e.seFilter,r=[{value:"1",column:"tl.name",direction:"ASC",label:"\u041f\u043e \u0438\u043c\u0435\u043d\u0438 (\u0432\u043e\u0437\u0440\u043e\u0441\u0442\u0430\u043d\u0438\u044e)"},{value:"2",column:"tl.name",direction:"DESC",label:"\u041f\u043e \u0438\u043c\u0435\u043d\u0438 (\u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e)"},{value:"3",column:"tl.email",direction:"ASC",label:"\u041f\u043e \u043c\u0435\u0439\u043b\u0443 (\u0432\u043e\u0437\u0440\u043e\u0441\u0442\u0430\u043d\u0438\u044e)"},{value:"4",column:"tl.email",direction:"DESC",label:"\u041f\u043e \u043c\u0435\u0439\u043b\u0443 (\u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e)"},{value:"5",column:"tl.text",direction:"ASC",label:"\u041f\u043e \u0442\u0435\u043a\u0441\u0442\u0443 (\u0432\u043e\u0437\u0440\u043e\u0441\u0442\u0430\u043d\u0438\u044e)"},{value:"6",column:"tl.text",direction:"DESC",label:"\u041f\u043e \u0442\u0435\u043a\u0441\u0442\u0443 (\u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e)"}];return(0,v.jsxs)(s.Z,{position:"apart",className:"pt-3",children:[(0,v.jsx)(u.o,{placeholder:"\u0418\u043c\u044f \u0438\u043b\u0438 email",radius:"md",onChange:function(e){return a(e.target.value)}}),(0,v.jsxs)(s.Z,{direction:"row",children:[(0,v.jsx)(c.Ph,{placeholder:"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430",onChange:function(e){return n(r.filter((function(t){if(t.value===e)return t}))[0])},data:r}),(0,v.jsx)(d.A,{onClick:function(){return t()},variant:"outline",className:"text-blue-500 hover:text-indigo-600",children:(0,v.jsx)(m.D,{className:"text-blue-500 hover:text-indigo-600"})})]})]})},f=a(4539),h=a(8727),x=a(6018),g=a(1265),b=a(4386),Z=a(1134),y=a(9434),E=a(5564),j=a(6140);var S=b.Ry().shape({name:b.Z_("\u0414\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0430").required("some").min(3,"some").max(100,"some"),email:b.Z_("\u0414\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0430").required("some").min(3,"some").max(100,"some"),text:b.Z_("\u0414\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0430").required("some").min(3,"some").max(1e3,"some")}),_=function(e){var t,a,r,l=e.visible,s=e.setCloseModal,c=e.form,d=e.values,m=e.token,p=e.updatePost,b=e.addPost,_=(0,y.I0)(),T=(0,Z.cI)({resolver:(0,g.X)(S)}),A=(T.getValues,T.setValue),C=T.formState.errors,k=(T.setError,T.reset),P=T.register,w=T.handleSubmit;(0,o.useEffect)((function(){l&&"add"!==c&&Object.keys(d).forEach((function(e){"id"!==e&&A(e,d[e])}))}),[l]);var D=(0,o.useState)(),N=(0,n.Z)(D,2),I=N[0],O=N[1];return(0,v.jsx)(f.u,{opened:l,onClose:function(){s(),k({name:"",text:"",email:""})},title:"add"===c?"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c":"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c",centered:!0,radius:"md",children:(0,v.jsxs)("form",{onSubmit:w((function(e){O(!0),_((0,E.v_)({url:"add"===c?"/api/add-post":"api/admin/update-post/".concat(null===d||void 0===d?void 0:d.id),token:m,data:e,action:function(t){t.success?("add"===c?(b(t.data.rows),j.ZP.success("\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e")):(console.log("hello update success"),p((0,i.Z)((0,i.Z)({id:null===d||void 0===d?void 0:d.id},e),{},{status_id:2}))),O(!1),k({name:"",email:"",text:""})):j.ZP.error("\u0447\u0442\u043e \u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a")}}))})),className:"w-full flex flex-col",children:[(0,v.jsx)(u.o,(0,i.Z)((0,i.Z)({className:"mt-1",label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0438\u043c\u044f",placeholder:"\u0414\u043e\u0432\u0440\u0430\u043d"},P("name")),{},{error:null===C||void 0===C||null===(t=C.name)||void 0===t?void 0:t.message})),(0,v.jsx)(u.o,(0,i.Z)((0,i.Z)({className:"mt-1",label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448 email",placeholder:"ddowran2106@gmail.com"},P("email")),{},{error:null===C||void 0===C||null===(a=C.email)||void 0===a?void 0:a.message})),(0,v.jsx)(h.g,(0,i.Z)((0,i.Z)({className:"mt-1 ",label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448 \u0442\u0435\u043a\u0441\u0442",placeholder:"\u043a\u0430\u043a\u043e\u0439\u0442\u043e \u0442\u0435\u043a\u0441\u0442"},P("text")),{},{error:null===C||void 0===C||null===(r=C.text)||void 0===r?void 0:r.message})),(0,v.jsx)(x.z,{loading:I,variant:"outline",type:"submit",className:"mt-2",children:"add"===c?"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c":"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"})]})})},T=a(1700),A=a(5071),C=a(7582);var k=function(e){var t=e.item,a=e.token,n=e.openEditForm,r=e.submitData,i=(0,y.I0)();return(0,v.jsxs)(T.Z,{className:"bg-gray-50 shadow-inner",children:[(0,v.jsxs)(s.Z,{direction:"row",children:[(0,v.jsx)("p",{className:"text-red-400",children:1===+t.status_id?"\u041d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e":2===+(null===t||void 0===t?void 0:t.status_id)?"\u0420\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u043e\u0432\u0430\u043d\u043e":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e"}),a&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(d.A,{onClick:function(){return n(t)},variant:"outline",children:(0,v.jsx)(A.H,{size:"22",className:"text-blue-500"})}),3!==t.status_id&&(0,v.jsx)(d.A,{variant:"outline",onClick:function(){i((0,E.v_)({url:"/api/admin/submit-post/".concat(t.id),token:a,action:function(e){e.success?(j.ZP.success("\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e"),r(t.id)):j.ZP.error("\u0427\u0442\u043e \u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a")}}))},children:(0,v.jsx)(C.D,{size:"22",className:"text-blue-500"})})]})]}),(0,v.jsxs)("p",{children:["\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c: ",t.name]}),(0,v.jsxs)("p",{children:["Email: ",t.email]}),(0,v.jsx)("p",{children:"\u0422\u0435\u043a\u0441\u0442"}),(0,v.jsx)("p",{children:t.text})]})},P=a(1312),w=a(8601),D=function(e){var t=e.setPage,a=e.page,n=e.total;return(0,v.jsx)(w.t,{size:"xs",radius:"md",total:n,boundaries:1,initialPage:1,onChange:t,page:a,classNames:{active:"bg-blue-500"},siblings:1,getItemAriaLabel:function(e){switch(e){case"dots":return"dots element aria-label";case"prev":return"previous page button aria-label";case"next":return"next page button aria-label";case"first":return"first page button aria-label";case"last":return"last page button aria-label";default:return"".concat(e," item aria-label")}}})};var N=function(e){var t=e.action,a=e.time,r=(0,o.useState)(0),i=(0,n.Z)(r,2),l=i[0],s=i[1];return function(e){l&&clearTimeout(l),s(setTimeout((function(){t(e)}),a))}};function I(e,t){var a,n,o;switch(t.type){case"SET_VISIBLE_FORM":return(0,i.Z)((0,i.Z)({},e),{},{visible:!0,form:"add",values:{}});case"SET_CLOSE_MODAL":return(0,i.Z)((0,i.Z)({},e),{},{values:{},visible:!1});case"SET_SEARCH":return(0,i.Z)((0,i.Z)({},e),{},{search:t.payload,trigger:!e.trigger,page:1});case"SET_FILTER":return(0,i.Z)((0,i.Z)({},e),{},{column:null===(a=t.payload)||void 0===a?void 0:a.column,direction:null===(n=t.payload)||void 0===n?void 0:n.direction,trigger:!(null!==e&&void 0!==e&&e.trigger),page:1});case"SET_DATA":return(0,i.Z)((0,i.Z)({},e),{},{data:t.payload.list,count:t.payload.count});case"SET_PAGE":return(0,i.Z)((0,i.Z)({},e),{},{page:t.payload,trigger:!e.trigger});case"OPEN_EDIT_FORM":return(0,i.Z)((0,i.Z)({},e),{},{visible:!0,values:t.payload,form:"update"});case"UPDATE_POST":return(0,i.Z)((0,i.Z)({},e),{},{visible:!1,data:e.data.map((function(e){return+e.id===+t.payload.id?t.payload:e}))});case"CLEAR":return(0,i.Z)((0,i.Z)({},e),{},{data:[]});case"ADD_POST":return(0,i.Z)((0,i.Z)({},e),{},{data:[t.payload].concat((0,r.Z)(null===(o=e.data)||void 0===o?void 0:o.slice(0,2))),visible:!1});case"SUBMIT_DATA":return(0,i.Z)((0,i.Z)({},e),{},{data:e.data.map((function(e){return+e.id===+t.payload&&(e.status_id=3),e}))});default:return e}}var O=function(){var e,t=(0,o.useReducer)(I,{data:[],count:0,page:1,limit:3,search:"",column:"",direction:"",visible:"",form:"",values:{},tigger:!0}),a=(0,n.Z)(t,2),r=a[0],i=a[1],s=(0,y.I0)();(0,o.useEffect)((function(){i({type:"CLEAR",payload:""}),s((0,E.U2)({url:"api/get-posts?page=".concat(r.page-1,"&limit=").concat(r.limit,"&column=").concat(r.column?r.column:"","&direction=").concat(r.direction?r.direction:"","&search=").concat(null===r||void 0===r?void 0:r.search),action:function(e){var t;e.success?i({type:"SET_DATA",payload:null===(t=e.data)||void 0===t?void 0:t.rows}):j.ZP.error("sometihnig went wwronf")}}))}),[r.trigger]);var u=N({action:function(e){return i({type:"SET_SEARCH",payload:e})},time:500}),c=(0,y.v9)((function(e){var t;return null===e||void 0===e||null===(t=e.auth)||void 0===t?void 0:t.token}));return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(l.Z,{}),(0,v.jsx)(p,{openModal:function(){return i({type:"SET_VISIBLE_FORM",payload:""})},handleSearch:function(e){return u(e)},seFilter:function(e){return i({type:"SET_FILTER",payload:e})}}),(0,v.jsx)(_,{token:c,values:r.values,form:null===r||void 0===r?void 0:r.form,visible:null===r||void 0===r?void 0:r.visible,setCloseModal:function(){return i({type:"SET_CLOSE_MODAL",payload:""})},updatePost:function(e){return i({type:"UPDATE_POST",payload:e})},addPost:function(e){return i({type:"ADD_POST",payload:e})}}),(0,v.jsx)(P.r,{className:"pt-10 pb-5",children:(null===(e=r.data)||void 0===e?void 0:e.length)&&r.data.map((function(e){return(0,v.jsx)(P.r.Col,{span:4,children:(0,v.jsx)(k,{submitData:function(e){return i({type:"SUBMIT_DATA",payload:e})},openEditForm:function(e){return i({type:"OPEN_EDIT_FORM",payload:e})},token:c,item:e})},e.id)}))}),(0,v.jsx)(D,{page:r.page,total:Math.floor(r.count/r.limit)+1,setPage:function(e){return i({type:"SET_PAGE",payload:e})}})]})}}}]);
//# sourceMappingURL=517.e7679d69.chunk.js.map